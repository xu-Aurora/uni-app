{"version":3,"sources":["webpack:////Users/xucongmac/code/qingTian-app/uni_modules/map-plugin/components/map-plugin/map-plugin.vue?b881","webpack:////Users/xucongmac/code/qingTian-app/uni_modules/map-plugin/components/map-plugin/map-plugin.vue?d4fd","webpack:////Users/xucongmac/code/qingTian-app/uni_modules/map-plugin/components/map-plugin/map-plugin.vue?1c21","webpack:////Users/xucongmac/code/qingTian-app/uni_modules/map-plugin/components/map-plugin/map-plugin.vue?79be","uni-app:///uni_modules/map-plugin/components/map-plugin/map-plugin.vue","webpack:////Users/xucongmac/code/qingTian-app/uni_modules/map-plugin/components/map-plugin/map-plugin.vue?2054","webpack:////Users/xucongmac/code/qingTian-app/uni_modules/map-plugin/components/map-plugin/map-plugin.vue?0e46"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqR;AACrR;AAC8D;AACL;AACc;;;AAGvE;AACmN;AACnN,gBAAgB,iNAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,mPAAM;AACR,EAAE,4PAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uPAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,wQAEN;AACP;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjCA;AAAA;AAAA;AAAA;AAAu1B,CAAgB,wyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACU32B;;;;;;;;;;;;;;;;;;;;;AAqBA;AACA;AACA;AACA,iBADA;AAEA;AACA;AACA,OAJA,EADA;;AAOA;AACA,mBADA;AAEA,oBAFA,EAPA,EADA;;;AAaA,MAbA,kBAaA;AACA;AACA;AACA,iBADA;AAEA,+BAFA;AAGA,uBAHA;AAIA,sBAJA;AAKA,yBALA,EADA;;AAQA,sBARA;;AAUA,GAxBA;AAyBA,SAzBA,qBAyBA;;AAEA,GA3BA;AA4BA;AACA;AACA;AACA;AACA;AACA,OAJA;AAKA,gBALA,EADA,EA5BA;;;AAqCA;AACA;AACA,oBAFA,4BAEA,GAFA,EAEA;AACA;AACA,KAJA;;AAMA;AACA,mBAPA,2BAOA,GAPA,EAOA;AACA;AACA;AACA;AACA,KAXA;;AAaA;AACA,qBAdA,6BAcA,GAdA,EAcA;AACA;AACA;AACA,KAjBA,EArCA,E;;;;;;;;;;;;AC/BA;AAAA;AAAA;AAAA;AAAkkD,CAAgB,u6CAAG,EAAC,C;;;;;;;;;;;ACAtlD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"uni_modules/map-plugin/components/map-plugin/map-plugin.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./map-plugin.vue?vue&type=template&id=527abfa8&filter-modules=eyJibWFwIjp7InR5cGUiOiJyZW5kZXJqcyIsImNvbnRlbnQiOiIiLCJzdGFydCI6MTkzNCwiYXR0cnMiOnsibW9kdWxlIjoiYm1hcCIsImxhbmciOiJqcyJ9LCJlbmQiOjEwNzExfX0%3D&\"\nvar renderjs\nimport script from \"./map-plugin.vue?vue&type=script&lang=js&\"\nexport * from \"./map-plugin.vue?vue&type=script&lang=js&\"\nimport style0 from \"./map-plugin.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"uni_modules/map-plugin/components/map-plugin/map-plugin.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./map-plugin.vue?vue&type=template&id=527abfa8&filter-modules=eyJibWFwIjp7InR5cGUiOiJyZW5kZXJqcyIsImNvbnRlbnQiOiIiLCJzdGFydCI6MTkzNCwiYXR0cnMiOnsibW9kdWxlIjoiYm1hcCIsImxhbmciOiJqcyJ9LCJlbmQiOjEwNzExfX0%3D&\"","var components\ntry {\n  components = {\n    mapSearch: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/map-plugin/components/map-search/map-search\" */ \"@/uni_modules/map-plugin/components/map-search/map-search.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./map-plugin.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./map-plugin.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"content\">\r\n\t\t<view class=\"bMap-container\">\r\n\t\t\t<view @click=\"bmap.onClick\" :prop=\"mapData\" :change:prop=\"bmap.updateMap\" id=\"bmap\"></view>\r\n\t\t\t<view id=\"panel\"></view>\r\n\t\t</view>\r\n\t\t<map-search :backEvent=\"backEvent\" @changeSearchText=\"changeSearchText\" @addressInfoChange=\"addressInfoChange\" :searchResult=\"searchResult\"></map-search>\r\n\t</view>\n</template>\n<script>\r\n/**\r\n * map-plugin 地图\r\n * @description map-plugin\r\n * @property {Array} routeNodeList 轨迹点位\r\n * @example [\r\n\t\t{\r\n\t\t\tlongitude: 120.610749,\r\n\t\t\tlatitude: 31.328650,\r\n\t\t\tnodeName: '苏州火车站'\r\n\t\t},{\r\n\t\t\tlongitude: 120.678630,\r\n\t\t\tlatitude: 31.316992,\r\n\t\t\tnodeName: '东方之门'\r\n\t\t},{\r\n\t\t\tlongitude: 120.640200,\r\n\t\t\tlatitude: 31.305598,\r\n\t\t\tnodeName: '苏州大学'\r\n\t\t},\r\n\t]\r\n * @property {Boolean} backEvent 返回事件\r\n */\r\n\texport default {\r\n\t\tprops: {\r\n\t\t\trouteNodeList: {\r\n\t\t\t\ttype: Array,\r\n\t\t\t\tdefault:()=>{\r\n\t\t\t\t\treturn []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbackEvent: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tmapData: {\r\n\t\t\t\t\tinput: '',\r\n\t\t\t\t\trouteNodesChange: false,\r\n\t\t\t\t\tgetPosition: '',\r\n\t\t\t\t\trouteNodes: [],\r\n\t\t\t\t\tallRouteNodes:''\r\n\t\t\t\t},\r\n\t\t\t\tsearchResult: []\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\t\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\trouteNodeList:{\r\n\t\t\t\thandler:function(newVal,oldVal) {\r\n\t\t\t\t\tthis.mapData.routeNodes = newVal\r\n\t\t\t\t\tthis.mapData.routeNodesChange = !this.mapData.routeNodesChange\r\n\t\t\t\t},\r\n\t\t\t\tdeep: true\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 搜索关键词改变执行搜索\r\n\t\t\tchangeSearchText(val) {\r\n\t\t\t\tthis.mapData.input = val\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 获取搜索列表\r\n\t\t\tgetSearchResult(val) {\r\n\t\t\t\tif(val && val.length) {\r\n\t\t\t\t\tthis.searchResult = val.filter(item => item.id)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 起止地址变换获取路线\r\n\t\t\taddressInfoChange(val) {\r\n\t\t\t\tthis.mapData.routeNodes = val\r\n\t\t\t\tthis.mapData.routeNodesChange = !this.mapData.routeNodesChange\r\n\t\t\t}\r\n\t\t}\r\n\t}\n</script>\r\n\r\n<!-- 组件中的renderjs引用图片好像找不着本地的，所以换成了网络图片，可自行修改 -->\r\n<script module=\"bmap\" lang=\"renderjs\">\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tmap: null,\r\n\t\t\t\tmarkerList: [{\r\n\t\t\t\t\tlat: 0,\r\n\t\t\t\t\tlng: 0,\r\n\t\t\t\t\ticon: ''\r\n\t\t\t\t}],\r\n\t\t\t\townerInstanceObj: null ,//service层对象\r\n\t\t\t\tstartIcon:null,\r\n\t\t\t\tviaIcon:null,\r\n\t\t\t\tendIcon:null,\r\n\t\t\t\tdriving: null,\r\n\t\t\t\trouteList: [],\r\n\t\t\t\tisInitIcon:true\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tif (typeof window.BMap === 'function') {\r\n\t\t\t\tthis.initMap()\r\n\t\t\t} else {\r\n\t\t\t\t// 动态引入较大类库避免影响页面展示\r\n\t\t\t\tconst script = document.createElement('script')\r\n\t\t\t\tconst AK = '1f124a30c8db9528423b769d1819b5b1' //使用自己的高德地图key值（ 是webApi的key!!! ）\r\n\t\t\t\tscript.src = 'https://webapi.amap.com/maps?v=2.0&key=' + AK +\r\n\t\t\t\t\t'&plugin=AMap.Driving&plugin=AMap.Autocomplete&plugin=AMap.CitySearch' //需要什么功能就加什么plugin\r\n\t\t\t\tscript.onload = this.initMap.bind(this)\r\n\t\t\t\tdocument.head.appendChild(script)\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tmethods: {\r\n\t\t\ttransData(method, value) { //传输数据 H5有限制，使用ownerInstanceObj.callMethod 代替操作\r\n\t\t\t\tUniViewJSBridge.publishHandler('onWxsInvokeCallMethod', {\r\n\t\t\t\t\tcid: this._$id,\r\n\t\t\t\t\tmethod: method,\r\n\t\t\t\t\targs: value\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tinitMap() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tthis.map = new AMap.Map('bmap', {\r\n\t\t\t\t\tresizeEnable: true,\r\n\t\t\t\t\t// center: [this.mapData.longitude, this.mapData.latitude],\r\n\t\t\t\t\tlayers: [ //使用多个图层\r\n\t\t\t\t\t\t// new AMap.TileLayer.Satellite() //使用卫星图\r\n\t\t\t\t\t],\r\n\t\t\t\t\tzooms: [4, 18], //设置地图级别范围\r\n\t\t\t\t\tzoom: 16\r\n\t\t\t\t})\r\n\t\t\t\tthis.map.on('complete', function(){\r\n\t\t\t\t    // 地图图块加载完成后触发\r\n\t\t\t\t\tthat.geoLocation()\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgeoLocation() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tAMap.plugin('AMap.Geolocation', function() {\r\n\t\t\t\t\tvar geolocation = new AMap.Geolocation({\r\n\t\t\t\t\t\t// 是否使用高精度定位，默认：true\r\n\t\t\t\t\t\tenableHighAccuracy: true,\r\n\t\t\t\t\t\t// 设置定位超时时间，默认：无穷大\r\n\t\t\t\t\t\ttimeout: 10000,\r\n\t\t\t\t\t\t// 定位按钮的停靠位置的偏移量，默认：Pixel(10, 20)\r\n\t\t\t\t\t\tbuttonOffset: new AMap.Pixel(10, 20),\r\n\t\t\t\t\t\t//  定位成功后调整地图视野范围使定位位置及精度范围视野内可见，默认：false\r\n\t\t\t\t\t\tzoomToAccuracy: true,\r\n\t\t\t\t\t\t//  定位按钮的排放位置,  RB表示右下\r\n\t\t\t\t\t\tbuttonPosition: 'RB',\r\n\t\t\t\t\t\tshowMarker: false,\r\n\t\t\t\t\t\tshowCircle: false,\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tthat.map.addControl(geolocation);\r\n\t\t\t\t\tgeolocation.getCurrentPosition(function(status, result) {\r\n\t\t\t\t\t\tthat.initIcon()\r\n\t\t\t\t\t\tif (status == 'complete') {\r\n\t\t\t\t\t\t\tonComplete(result)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tonError(result)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tfunction onComplete(data) {\r\n\t\t\t\t\t\tthat.markerList[0].lat = data.position.lat\r\n\t\t\t\t\t\tthat.markerList[0].lng = data.position.lng\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// that.ownerInstanceObj.callMethod('getCurrentCity',{\r\n\t\t\t\t\t\t// \tlatitude: data.position.lat,\r\n\t\t\t\t\t\t// \tlongitude: data.position.lng\r\n\t\t\t\t\t\t// })\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthat.initMarkers()\r\n\t\t\t\t\t\t// that.getCity()\r\n\t\t\t\t\t\t// data是具体的定位信息\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfunction onError(data) {\r\n\t\t\t\t\t\tconsole.log('error')\r\n\t\t\t\t\t\t// 定位出错\r\n\t\t\t\t\t}\r\n\t\t\t\t})\t\t\t\t\r\n\t\t\t},\r\n\t\t\tgetCity() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tthat.map.plugin('AMap.CitySearch', function() {\r\n\t\t\t\t\t// 实例化CitySearch\r\n\t\t\t\t\tvar CitySearch = new AMap.CitySearch();\r\n\t\t\t\t\tCitySearch.getLocalCity(function(status, result) {\r\n\t\t\t\t\t\t// 搜索成功时，result即是对应的匹配数据\r\n\t\t\t\t\t\tif (status === 'complete' && result.info === 'OK') {\r\n\t\t\t\t\t\t\tif (result && result.city && result.bounds) {\r\n\t\t\t\t\t\t\t\t// that.transData('locationCity', result.city)\r\n\t\t\t\t\t\t\t\tthat.ownerInstanceObj.callMethod('locationCity', result.city)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//初始化标记点\r\n\t\t\tinitMarkers() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tthis.map.clearMap();\r\n\t\t\t\tthis.markerList.forEach((item, index) => {\r\n\t\t\t\t\tif (!!item.icon && !index) {\r\n\t\t\t\t\t\tlet icon = new AMap.Icon({\r\n\t\t\t\t\t\t\t// 图标尺寸\r\n\t\t\t\t\t\t\tsize: new AMap.Size(38, 50),\r\n\t\t\t\t\t\t\t// 图标的取图地址\r\n\t\t\t\t\t\t\timage: 'https://www.morn-stars.com/portal-site/person-position.png',\r\n\t\t\t\t\t\t\t// 图标所用图片大小\r\n\t\t\t\t\t\t\timageSize: new AMap.Size(19, 25),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//添加点标记\r\n\t\t\t\t\t\tlet marker = new AMap.Marker({\r\n\t\t\t\t\t\t\tposition: new AMap.LngLat(item.lng, item.lat),\r\n\t\t\t\t\t\t\toffset: new AMap.Pixel(-13, -30),\r\n\t\t\t\t\t\t\ticon: icon\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.map.add(marker)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tthis.map.on('click', (e) => {\r\n\t\t\t\t\t// that.transData('onViewClick', 'down')\r\n\t\t\t\t\tthat.ownerInstanceObj.callMethod('onViewClick', 'down')\r\n\t\t\t\t})\r\n\t\t\t\tthis.map.setZoomAndCenter(16, [this.markerList[0].lng, this.markerList[0].lat]); //定位到您所在的位置\r\n\t\t\t},\r\n\t\t\tinitIcon(){\r\n\t\t\t\t// 创建一个 Icon\r\n\t\t\t\tthis.startIcon = new AMap.Icon({\r\n\t\t\t\t\t// 图标尺寸\r\n\t\t\t\t\tsize: new AMap.Size(25, 34),\r\n\t\t\t\t\t// 图标的取图地址\r\n\t\t\t\t\timage: 'https://www.morn-stars.com/portal-site/dir-marker.png',\r\n\t\t\t\t\t// 图标所用图片大小\r\n\t\t\t\t\timageSize: new AMap.Size(135, 40),\r\n\t\t\t\t\t// 图标取图偏移量\r\n\t\t\t\t\timageOffset: new AMap.Pixel(-9, -3)\r\n\t\t\t\t});\r\n\t\t\t\tthis.viaIcon = new AMap.Icon({\r\n\t\t\t\t\t// 图标尺寸\r\n\t\t\t\t\tsize: new AMap.Size(25, 34),\r\n\t\t\t\t\t// 图标的取图地址\r\n\t\t\t\t\timage: 'https://www.morn-stars.com/portal-site/dir-marker.png',\r\n\t\t\t\t\t// 图标所用图片大小\r\n\t\t\t\t\timageSize: new AMap.Size(135, 40),\r\n\t\t\t\t\t// 图标取图偏移量\r\n\t\t\t\t\timageOffset: new AMap.Pixel(-54, -3)\r\n\t\t\t\t});\r\n\t\t\t\tthis.endIcon = new AMap.Icon({\r\n\t\t\t\t\t// 图标尺寸\r\n\t\t\t\t\tsize: new AMap.Size(25, 34),\r\n\t\t\t\t\t// 图标的取图地址\r\n\t\t\t\t\timage: 'https://www.morn-stars.com/portal-site/dir-marker.png',\r\n\t\t\t\t\t// 图标所用图片大小\r\n\t\t\t\t\timageSize: new AMap.Size(135, 40),\r\n\t\t\t\t\t// 图标取图偏移量\r\n\t\t\t\t\timageOffset: new AMap.Pixel(-95, -3)\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tmarkerClick(e) {\r\n\t\t\t\tlet infoWindow = new AMap.InfoWindow({offset: new AMap.Pixel(0, -30)});\r\n\t\t\t\tinfoWindow.setContent(e.target.content);\r\n\t\t\t\tinfoWindow.open(this.map, e.target.getPosition());\r\n\t\t\t},\r\n\t\t\taddMarker(routerList){\r\n\t\t\t\trouterList.forEach((item, index) => {\r\n\t\t\t\t\t//添加点标记\r\n\t\t\t\t\tlet marker = new AMap.Marker({\r\n\t\t\t\t\t\tposition: new AMap.LngLat(item[0], item[1]),\r\n\t\t\t\t\t\toffset: new AMap.Pixel(-13, -30),\r\n\t\t\t\t\t\ticon: index === 0? this.startIcon:index === 1? this.endIcon:this.viaIcon\r\n\t\t\t\t\t})\r\n\t\t\t\t\tmarker.content = \"<div style='font-size:12px'>\" + item[2] + \"</div>\";\r\n\t\t\t\t\tmarker.on('click', this.markerClick);\r\n\t\t\t\t\tthis.map.add(marker)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tdrive(routeNodes,isAll = false) {\r\n\t\t\t\tlet routerList = [];\r\n\t\t\t\trouteNodes.forEach((item, index) => {\r\n\t\t\t\t\tif (index != routeNodes.length - 1) {\r\n\t\t\t\t\t\trouterList.push([item.longitude, item.latitude,item.nodeName])\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\t\trouterList.splice(1,0,[item.longitude, item.latitude,item.nodeName])\r\n\t\t\t\t\t}  \r\n\t\t\t\t})\r\n\t\t\t\tif (this.map && this.endIcon ) {\r\n\t\t\t\t\tif(this.driving && !isAll){\t\r\n\t\t\t\t\t\tthis.map.clearMap();\r\n\t\t\t\t\t\tthis.driving.clear();\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t// Driving 即是对应的驾车导航信息，相关数据结构文档请参考  https://lbs.amap.com/api/javascript-api/reference/route-search#m_AMap.Driving\r\n\t\t\t\t\t\tthis.driving = new AMap.Driving({\r\n\t\t\t\t\t\t\tmap: this.map,\r\n\t\t\t\t\t\t\tpanel: \"panel\",\r\n\t\t\t\t\t\t\tpolicy: AMap.DrivingPolicy.REAL_TRAFFIC,\r\n\t\t\t\t\t\t\thideMarkers:true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.routeList = routerList\r\n\t\t\t\t\tthis.addMarker(routerList)\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet waypoints = [];\r\n\t\t\t\t\tif(routerList.length > 2){\r\n\t\t\t\t\t\tlet router = routerList.slice(2)\r\n\t\t\t\t\t\trouter.forEach(item=>{\r\n\t\t\t\t\t\t\twaypoints.push(new AMap.LngLat(item[0], item[1]))\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.driving.search(new AMap.LngLat(routerList[0][0], routerList[0][1]), new AMap.LngLat(routerList[1][0], routerList[1][1]),{\r\n\t\t\t\t\twaypoints:waypoints},\r\n\t\t\t\t\t\tfunction(status, result) {\r\n\t\t\t\t\t\t\t// result 即是对应的驾车导航信息，相关数据结构文档请参考  https://lbs.amap.com/api/javascript-api/reference/route-search#m_DrivingResult\r\n\t\t\t\t\t\t\tif (status === 'complete') {\r\n\t\t\t\t\t\t\t\t// console.log(result)\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.log('失败：' + result)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\tthis.drive(routeNodes,isAll)\r\n\t\t\t\t\t},500)\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t},\r\n\t\t\tsearchData(keywords) {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tthis.map.plugin('AMap.AutoComplete', function() {\r\n\t\t\t\t\t// 实例化Autocomplete\r\n\t\t\t\t\tlet autoOptions = {\r\n\t\t\t\t\t\tcity: '苏州'\r\n\t\t\t\t\t};\r\n\t\t\t\t\tlet autoComplete = new AMap.Autocomplete(autoOptions);\r\n\t\t\t\t\tautoComplete.search(keywords, function(status, result) {\r\n\t\t\t\t\t\t// 搜索成功时，result即是对应的匹配数据\r\n\t\t\t\t\t\tlet addressList = [];\r\n\t\t\t\t\t\tif (status === 'complete') {\r\n\t\t\t\t\t\t\taddressList = result.tips\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// that.transData('getSearchResult', addressList)\r\n\t\t\t\t\t\tthat.ownerInstanceObj.callMethod('getSearchResult', addressList)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tupdateMap(newValue, oldValue, ownerInstance, instance) {\r\n\t\t\t\t// 监听 service 层数据变更\r\n\t\t\t\tthis.ownerInstanceObj = ownerInstance\r\n\t\t\t\tif (newValue.routeNodes && newValue.routeNodes.length){\r\n\t\t\t\t\t// #ifndef H5\r\n\t\t\t\t\tif(newValue.routeNodesChange !== oldValue.routeNodesChange){\r\n\t\t\t\t\t\tthis.drive(newValue.routeNodes)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\tthis.drive(newValue.routeNodes)\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t}\r\n\t\t\t\tif (newValue.allRouteNodes && newValue.allRouteNodes.length){\r\n\t\t\t\t\tlet allRouteNodes = newValue.allRouteNodes\r\n\t\t\t\t\tallRouteNodes.forEach(item=>{\r\n\t\t\t\t\t\tthis.drive(item,true)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (newValue.input) {\r\n\t\t\t\t\tthis.searchData(newValue.input)\r\n\t\t\t\t} \r\n\t\t\t},\r\n\t\t\tonClick(event, ownerInstance) {\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\n\r\n<style lang=\"scss\">\r\n\t.content {\n\t\t#bmap{\r\n\t\t\twidth: 100vw;\r\n\t\t\theight: calc( 100vh - 44px );\r\n\t\t}\r\n\t\t#panel{\r\n\t\t\tdisplay: none;\r\n\t\t}\r\n\t\t.position{\r\n\t\t\twidth: 100rpx;\r\n\t\t\theight: 100rpx;\r\n\t\t\tposition: absolute;\r\n\t\t\tz-index: 9999;\r\n\t\t\ttop: 50vh;\r\n\t\t\tleft: 50vw;\r\n\t\t}\r\n\t}\r\n</style>\n","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./map-plugin.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./map-plugin.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1645753682177\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}